<!doctype html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="src/assets/css/style.css" />
    <link rel="stylesheet" href="src/assets/css/output.css" />
    <link
      rel="shortcut icon"
       href="src/assets/img/logo/49.png"
      type="image/x-icon"
    />
    <title>G TACK verification</title>
  </head>
  <body class="min-h-screen flex items-center justify-center">
    <!-- Language Dropdown  -->
    <div class="absolute top-10 left-20">
      <div class="relative inline-block text-left">
        <button
          id="langBtn"
          class="inline-flex justify-center gap-x-1.5 rounded-md bg-sky/10 px-3 py-2 text-sm font-semibold text-sky inset-ring-1 inset-ring-sky/5 hover:bg-sky/20"
        >
          language
          <svg
            viewBox="0 0 20 20"
            fill="currentColor"
            class="-mr-1 size-5 text-gray-400"
          >
            <path
              d="M5.22 8.22a.75.75 0 0 1 1.06 0L10 11.94l3.72-3.72a.75.75 0 1 1 1.06 1.06l-4.25 4.25a.75.75 0 0 1-1.06 0L5.22 9.28a.75.75 0 0 1 0-1.06Z"
            />
          </svg>
        </button>

        <!-- Dropdown Menu -->
        <div
          id="langMenu"
          class="hidden absolute right-0 mt-2 w-32 origin-top-right rounded-md bg-sky/15 outline-1 -outline-offset-1 outline-sky/10 shadow-lg"
        >
          <div class="py-1">
            <a
              href="otp.html"
              class="block px-4 py-2 font-semibold text-sm text-sky hover:bg-sky/10 hover:text-sun"
              >EN</a
            >
            <a
              href="otp.ar.html"
              class="block px-4 py-2 font-semibold text-sm text-sky hover:bg-sky/10 hover:text-sun"
              >AR</a
            >
          </div>
        </div>
      </div>
    </div>

    <main>
      <div
        class="flex flex-col justify-center mobile-xs:w-[350px] mobile-s:w-[365px] mobile-m:w-[389px] mobile-l:w-[389px] mobile-xl:w-[405px] ipad-m:w-[743px] ipad-l:w-[850px] h-[300px] labtop-s:w-[850px] labtop-s:h-[390px] border border-[#E5E5E5] rounded-xl px-2 py-6 lg:py-12 lg:px-8"
      >
        <!-- Logo -->
        <div class="sm:mx-auto sm:w-full sm:max-w-sm">
          <img
            src="src/assets/img/logo.png"
            alt="Logo"
            class="mx-auto h-16 w-40"
          />
        </div>

        <!-- Verification Form -->
        <div class="mt-10 sm:mx-auto sm:w-full sm:max-w-sm">
          <form action="#" method="POST" class="space-y-6">
            <!-- Verification Code Inputs -->
            <div>
              <label for="code" class="block text-sm/6 font-medium text-tep"
                >Verification Code</label
              >
              <div class="mt-2 flex gap-2 justify-center">
                <input
                  type="text"
                  maxlength="1"
                  autofocus
                  class="otp-input w-12 h-12 text-center border rounded-md text-bordlight text-lg focus:outline-2 focus:outline-sun"
                />
                <input
                  type="text"
                  maxlength="1"
                  class="otp-input w-12 h-12 text-center border rounded-md text-bordlight text-lg focus:outline-2 focus:outline-sun"
                />
                <input
                  type="text"
                  maxlength="1"
                  class="otp-input w-12 h-12 text-center border rounded-md text-bordlight text-lg focus:outline-2 focus:outline-sun"
                />
                <input
                  type="text"
                  maxlength="1"
                  class="otp-input w-12 h-12 text-center border rounded-md text-bordlight text-lg focus:outline-2 focus:outline-sun"
                />
              </div>
            </div>

            <!-- Verify Button -->
            <div>
              <button
                type="button"
                id="verifyBtn"
                class="flex w-full justify-center rounded-md bg-sky px-3 py-1.5 text-sm/6 font-semibold text-white hover:bg-sun focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-abyss"
              >
                Verify
              </button>
            </div>

            <!-- Info and Timer -->
            <div
              class="flex justify-between text-sm text-gray-500 mt-2 items-center"
            >
              <span>Verification code sent to your mobile</span>

              <!-- Timer -->
              <span id="timer" class="text-sky"> </span>

              <!-- Resend Button -->
              <button
                id="resendBtn"
                type="button"
                class="hidden text-sky font-semibold hover:underline"
              >
                Send again
              </button>
            </div>

            <!-- Mobile Number Display -->
            <div id="displayNumber" class="text-sm text-sky mt-1"></div>
          </form>
        </div>
      </div>
    </main>

    <script src="src/assets/js/main.js"></script>
    <!-- Show saved phone number -->
    <script>
      // Display saved phone number from localStorage
      const savedPhone = localStorage.getItem("userPhone");
      document.getElementById("displayNumber").textContent =
        savedPhone || "+20 123 456 7890";
    </script>

    <!-- Countdown timer with resend button -->
    <script>
      let totalSeconds = 0.25 * 60;
      const timerElement = document.getElementById("timer");
      const resendBtn = document.getElementById("resendBtn");

      const startCountdown = () => {
        const countdown = setInterval(() => {
          const minutes = Math.floor(totalSeconds / 60);
          const seconds = totalSeconds % 60;
          timerElement.textContent = `${minutes}:${
            seconds < 10 ? "0" : ""
          }${seconds}`;
          totalSeconds--;

          if (totalSeconds < 0) {
            clearInterval(countdown);
            timerElement.classList.add("hidden");
            resendBtn.classList.remove("hidden");
          }
        }, 1000);
      };

      startCountdown();

      resendBtn.addEventListener("click", () => {
        totalSeconds = 0.25 * 60;
        timerElement.classList.remove("hidden");
        resendBtn.classList.add("hidden");
        startCountdown();
      });
    </script>

    <!-- OTP input auto move + auto redirect -->
    <script>
      const inputs = document.querySelectorAll(".otp-input");
      const verifyBtn = document.getElementById("verifyBtn");

      // Function to check if all inputs are filled
      function checkAndRedirect() {
        const allFilled = Array.from(inputs).every((inp) => inp.value !== "");
        if (allFilled) {
          window.location.href = "overview.en.html";
        }
      }

      // Event for inputs
      inputs.forEach((input, index) => {
        input.addEventListener("input", () => {
          input.value = input.value.replace(/[^0-9]/g, ""); // Allow only numbers

          if (input.value.length === 1 && index < inputs.length - 1) {
            inputs[index + 1].focus();
          }

          checkAndRedirect(); // Auto redirect if all filled
        });

        input.addEventListener("keydown", (e) => {
          if (e.key === "Backspace" && input.value === "" && index > 0) {
            inputs[index - 1].focus();
          }

          // Enter key
          if (e.key === "Enter") {
            checkAndRedirect();
          }
        });
      });

      // Event for button click
      verifyBtn.addEventListener("click", () => {
        checkAndRedirect();
      });
    </script>
  </body>
</html>
